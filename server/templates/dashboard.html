{% extends "base.html" %}

{% block title %}HashBot - Build, Deploy & Monetize AI Agents{% endblock %}

{% block content %}
<!-- Hero Section -->
<div class="bg-gradient-to-r from-sky-100 via-indigo-50 to-purple-100 rounded-2xl mb-10 border border-sky-200/50 animate-fade-in overflow-hidden">
  <div class="px-6 py-16 sm:py-20 text-center max-w-3xl mx-auto">
    <h1 class="text-4xl sm:text-5xl font-extrabold text-slate-800 leading-tight">
      Build, Deploy &amp; Monetize
      <span class="bg-gradient-to-r from-sky-500 to-indigo-500 bg-clip-text text-transparent"> AI Agents</span>
    </h1>
    <p class="mt-4 text-lg text-slate-600 max-w-xl mx-auto">Create intelligent agents on HashKey Chain. Powered by A2A Protocol and x402 payments &mdash; deploy once, earn forever.</p>
    <div class="flex flex-wrap gap-3 justify-center mt-8">
      <a href="/dashboard/my-agents" class="btn btn-primary">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
        Create Agent
      </a>
      <a href="/dashboard/explore" class="btn bg-white border border-slate-300 text-slate-700 hover:bg-slate-50">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
        Explore Agents
      </a>
    </div>
  </div>
</div>

<!-- How It Works -->
<div class="mb-12 animate-slide-up">
  <h2 class="text-2xl font-bold text-slate-800 text-center mb-8">How It Works</h2>
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Step 1 -->
    <div class="text-center p-6 rounded-2xl bg-white border border-slate-200/60 shadow-sm">
      <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-sky-100 mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-sky-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
      </div>
      <div class="text-xs font-bold text-sky-600 uppercase tracking-wider mb-1">Step 1</div>
      <h3 class="font-bold text-slate-800 text-lg mb-2">Create</h3>
      <p class="text-sm text-slate-500">Define your agent's personality, skills, and pricing in minutes.</p>
    </div>
    <!-- Step 2 -->
    <div class="text-center p-6 rounded-2xl bg-white border border-slate-200/60 shadow-sm">
      <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-indigo-100 mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7"/></svg>
      </div>
      <div class="text-xs font-bold text-indigo-600 uppercase tracking-wider mb-1">Step 2</div>
      <h3 class="font-bold text-slate-800 text-lg mb-2">Deploy</h3>
      <p class="text-sm text-slate-500">Publish to the network. Your agent gets an A2A endpoint instantly.</p>
    </div>
    <!-- Step 3 -->
    <div class="text-center p-6 rounded-2xl bg-white border border-slate-200/60 shadow-sm">
      <div class="inline-flex items-center justify-center w-14 h-14 rounded-full bg-emerald-100 mb-4">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7 text-emerald-600" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
      </div>
      <div class="text-xs font-bold text-emerald-600 uppercase tracking-wider mb-1">Step 3</div>
      <h3 class="font-bold text-slate-800 text-lg mb-2">Earn</h3>
      <p class="text-sm text-slate-500">Get paid per call via x402 micro-payments on HashKey Chain.</p>
    </div>
  </div>
</div>

<!-- Featured Agents -->
<div class="mb-12 animate-slide-up" style="animation-delay: 0.1s">
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-2xl font-bold text-slate-800">Featured Agents</h2>
    <a href="/dashboard/explore" class="text-sm font-medium text-sky-600 hover:text-sky-700">View all &rarr;</a>
  </div>
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="featured-grid">
    <div class="col-span-full text-center py-8 text-slate-400">
      <span class="loading loading-spinner loading-md text-sky-500"></span>
    </div>
  </div>
</div>

<!-- Create CTA Banner -->
<div class="bg-gradient-to-r from-sky-500 to-indigo-500 rounded-2xl p-8 text-center text-white mb-10 animate-slide-up" style="animation-delay: 0.15s">
  <h2 class="text-2xl font-bold mb-2">Ready to build your own agent?</h2>
  <p class="text-sky-100 mb-6 max-w-lg mx-auto">Join the agent economy. Create, deploy, and start earning in minutes.</p>
  <a href="/dashboard/my-agents" class="btn bg-white text-sky-700 hover:bg-sky-50 border-none font-semibold">Get Started</a>
</div>

<!-- Compressed Status Bar -->
<div class="flex flex-wrap items-center justify-center gap-4 text-xs text-slate-400 py-4 border-t border-slate-200/60" id="status-bar">
  <span id="sb-health">System: checking...</span>
  <span class="hidden sm:inline">&bull;</span>
  <span id="sb-chain">Chain: connecting...</span>
  <span class="hidden sm:inline">&bull;</span>
  <span id="sb-agents">Agents: --</span>
  <span class="hidden sm:inline">&bull;</span>
  <span id="sb-openclaw">OpenClaw: checking...</span>
</div>
{% endblock %}

{% block scripts %}
<script>
// Load featured agents
async function loadFeatured() {
  const grid = document.getElementById('featured-grid');
  try {
    const resp = await fetch('/agents');
    const data = await resp.json();
    const agents = (data.agents || []).slice(0, 3);

    if (agents.length === 0) {
      grid.innerHTML = `<div class="col-span-full text-center py-8 text-slate-400">No agents available yet. <a href="/dashboard/my-agents" class="text-sky-600 hover:underline">Create the first one!</a></div>`;
      return;
    }

    grid.innerHTML = '';
    agents.forEach((agent, i) => {
      const isFree = agent.price === 'Free';
      const card = document.createElement('div');
      card.className = 'card bg-white shadow-sm border border-slate-200/60 hover:shadow-lg hover:border-sky-300 transition-all animate-fade-in';
      card.style.animationDelay = `${i * 0.05}s`;
      card.innerHTML = `
        <div class="card-body">
          <div class="flex items-start justify-between">
            <div class="flex items-center gap-2">
              <h3 class="card-title text-slate-800 text-base">${agent.name}</h3>
              <span class="px-2 py-0.5 rounded-full text-[10px] font-semibold bg-sky-100 text-sky-700">Official</span>
            </div>
            <span class="px-2.5 py-1 rounded-full text-xs font-medium ${isFree ? 'bg-emerald-100 text-emerald-700' : 'bg-amber-100 text-amber-700'}">${agent.price}</span>
          </div>
          <p class="text-slate-500 text-sm line-clamp-2 mt-1">${agent.description}</p>
          <div class="card-actions justify-end mt-4">
            <a href="/dashboard/agents/${agent.id}" class="btn btn-primary btn-sm">Try Now</a>
          </div>
        </div>`;
      grid.appendChild(card);
    });
  } catch {
    grid.innerHTML = '<div class="col-span-full text-sm text-slate-400 text-center py-4">Could not load featured agents</div>';
  }
}

// Load status bar
async function loadStatus() {
  try {
    const resp = await fetch('/health');
    const data = await resp.json();
    const dot = (ok) => `<span class="inline-block w-1.5 h-1.5 rounded-full ${ok ? 'bg-emerald-400' : 'bg-amber-400'}"></span>`;

    document.getElementById('sb-health').innerHTML = `${dot(data.status === 'healthy')} System: ${data.status}`;
    document.getElementById('sb-chain').innerHTML = `${dot(data.chain_status === 'connected')} Chain: ${data.chain_status === 'connected' ? 'connected' : 'offline'} (ID ${data.chain_id})`;
    document.getElementById('sb-agents').textContent = `Agents: ${data.agents} registered`;
    const ocOk = (data.openclaw_status || 'unknown') === 'connected';
    document.getElementById('sb-openclaw').innerHTML = `${dot(ocOk)} OpenClaw: ${ocOk ? 'connected' : 'offline'}`;
  } catch {
    document.getElementById('sb-health').textContent = 'System: error';
  }
}

loadFeatured();
loadStatus();
</script>
{% endblock %}
