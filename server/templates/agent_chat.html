{% extends "base.html" %}

{% block title %}HashBot - Chat with {{ agent.name }}{% endblock %}

{% block head %}
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
{% endblock %}

{% block content %}
<div class="flex flex-col h-[calc(100vh-12rem)] md:h-[calc(100vh-14rem)]">
  <!-- Agent header -->
  <div class="flex items-center gap-4 mb-4">
    <a href="/dashboard/agents" class="btn btn-ghost btn-sm">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
    </a>
    <div>
      <h1 class="text-xl font-bold">{{ agent.name }}</h1>
      <p class="text-sm opacity-60">{{ agent.description }}</p>
    </div>
    <div class="ml-auto">
      <span class="badge {{ 'badge-success' if agent.price == 'Free' else 'badge-warning' }}">{{ agent.price }}</span>
    </div>
  </div>

  <!-- Chat messages -->
  <div class="flex-1 overflow-y-auto bg-base-100 rounded-xl p-4 space-y-4" id="chat-messages">
    <div class="chat chat-start">
      <div class="chat-bubble chat-bubble-primary">
        Hello! I'm <strong>{{ agent.name }}</strong>. How can I help you today?
      </div>
    </div>
  </div>

  <!-- Input area -->
  <div class="mt-4 flex gap-2">
    <input
      type="text"
      id="chat-input"
      placeholder="Type your message..."
      class="input input-bordered flex-1"
      autocomplete="off"
    >
    <button id="send-btn" class="btn btn-primary" onclick="sendMessage()">
      <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"/></svg>
      Send
    </button>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
  const AGENT_ID = "{{ agent.id }}";
  const IS_OPENCLAW = {{ 'true' if agent.get('is_openclaw') else 'false' }};
</script>
<script src="/static/js/chat.js"></script>
{% endblock %}
